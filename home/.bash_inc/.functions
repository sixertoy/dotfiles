#!/usr/bin/env bash

DOTFILES_BASE=raw.githubusercontent.com/sixertoy/dotfiles/master

function init-eslint() {
  # copie du fichier de configuration
  FILE_NAME=.eslintrc.json
  FILE_URL=https://$DOTFILES_BASE/home/$FILE_NAME
  curl -o ./$FILE_NAME $FILE_URL
  # copie du fichier Ignore
  FILE_NAME=.eslintignore
  FILE_URL=https://$DOTFILES_BASE/home/$FILE_NAME
  curl -o ./$FILE_NAME $FILE_URL
  # installation des dependances
  npx install-peerdeps --dev --use-yarn eslint-config-airbnb
  yarn add eslint-config-prettier eslint-plugin-simple-import-sort eslint-plugin-sort-destructure-keys eslint-plugin-sort-keys-fix --dev
}

function init-prettier() {
  # copie du fichier de configuration
  FILE_NAME=.prettierrc.json
  FILE_URL=https://$DOTFILES_BASE/home/$FILE_NAME
  curl -o ./$FILE_NAME $FILE_URL
  # copie du fichier Ignore
  FILE_NAME=.prettierignore
  FILE_URL=https://$DOTFILES_BASE/home/$FILE_NAME
  curl -o ./$FILE_NAME $FILE_URL
  # installation des dependances
  npx install-peerdeps --dev prettier
  npx install-peerdeps --dev prettier-eslint
  npx install-peerdeps --dev prettier-stylelint
  npx install-peerdeps --dev prettier-eslint-cli
}

function init-stylelint() {
  # copie du fichier de configuration
  FILE_NAME=.stylelintrc.json
  FILE_URL=https://$DOTFILES_BASE/home/$FILE_NAME
  curl -o ./$FILE_NAME $FILE_URL
  # installation des dependances
  npx install-peerdeps --dev stylelint
  npx install-peerdeps --dev stylelint-config-standard
  npx install-peerdeps --dev stylelint-order
  npx install-peerdeps --dev stylelint-scss
}

function init-hooks() {
  # copie du fichier de configuration
  FILE_NAME=.huskyrc.json
  FILE_URL=https://$DOTFILES_BASE/home/$FILE_NAME
  curl -o ./$FILE_NAME $FILE_URL
  # copie du fichier de configuration
  FILE_NAME=.lintstagedrc.json
  FILE_URL=https://$DOTFILES_BASE/home/$FILE_NAME
  curl -o ./$FILE_NAME $FILE_URL
}

function init-dotfiles() {
  # copie du fichier de configuration
  FILE_NAME=.editorconfig
  FILE_URL=https://$DOTFILES_BASE/home/$FILE_NAME
  curl -o ./$FILE_NAME $FILE_URL
  # copie du fichier de configuration
  FILE_NAME=.yarnrc
  FILE_URL=https://$DOTFILES_BASE/home/$FILE_NAME
  curl -o ./$FILE_NAME $FILE_URL
  # creation du fichier .nvmrc
  touch .nvmrc
  echo "v12.13.1" > .nvmrc
}

# gitignore.io
# @see https://www.gitignore.io/docs
function init-gitignore() {
  curl -L -s https://www.gitignore.io/api/windows,linux,osx,macos,node,dotenv > .gitignore
  echo ".env.loc" >> .gitignore
  echo ".env.dev" >> .gitignore
  echo ".env.prod" >> .gitignore
  echo ".env.local" >> .gitignore
  echo ".env.production" >> .gitignore
  echo ".env.development" >> .gitignore
}

function init-babel() {
  # copie du fichier de configuration
  FILE_NAME=.babelrc
  FILE_URL=https://$DOTFILES_BASE/home/$FILE_NAME
  curl -o ./$FILE_NAME $FILE_URL
  # installation des dependances
  yarn add @babel/cli @babel/core @babel/node @babel/plugin-proposal-class-properties @babel/plugin-transform-runtime @babel/preset-env @babel/preset-react --dev
}

function init-project() {
  mkdir -p .kiss
  mkdir -p src/app
  mkdir -p src/scss
  mkdir -p src/static
  mkdir -p .scripts/hooks
  git init
  yarn init -Y
  init-gitignore
  init-dotfiles
  init-eslint
  init-prettier
  init-stylelint
  init-hooks
}
